# 批量裁切功能需求文档

## 1. 功能概述
实现一个可视化的批量图片裁切工具。用户可以在第一张图片（参考图）上通过拖拽、缩放选择裁切区域，并将该裁切区域（坐标和尺寸）应用到批量上传的所有图片中。

## 2. 界面交互 (UI/UX)
### 2.1 参考图显示
- **显示区域**：在设置面板或主预览区显示用户上传的第一张图片。
- **遮罩层**：图片上覆盖一层半透明黑色遮罩，高亮显示当前选中的裁切区域。

### 2.2 裁切框交互
- **拖拽**：鼠标左键按住裁切框内部可移动位置。
- **缩放**：鼠标拖动裁切框的 8 个控制点（四角和四边中点）调整大小。
- **网格**：裁切框内部显示"三等分"网格线（九宫格），辅助构图。

### 2.3 侧边栏/控制面板设置
提供以下参数控制：
1. **比例选择 (Aspect Ratio)**：
   - 提供一组预设比例按钮：
     - `自由` (Free/Custom) - 默认
     - `1:1` (正方形)
     - `4:3`
     - `3:4`
     - `16:9`
     - `9:16`
   - 选择比例后，调整裁切框时自动锁定宽高比。

2. **精确数值控制** (支持手动输入和实时显示):
   - **宽度 (Width)**: px
   - **高度 (Height)**: px
   - **位置 X**: px
   - **位置 Y**: px

## 3. 业务逻辑
### 3.1 批量处理规则
- **基准**：以第一张图片的裁切坐标 (X, Y, Width, Height) 为基准。
- **应用**：点击"转换全部"时，系统遍历所有上传的图片，使用**相同的坐标和尺寸**进行裁切。
- **边界处理**：如果后续图片尺寸小于裁切区域，则：
  - 方案 A（当前采用）：只裁切重叠部分（Canvas自动处理）。
  - *注：通常批量裁切场景下，用户上传的图片规格应当是一致的。*

### 3.2 初始状态
- 图片加载时，默认显示一个居中的裁切框（例如占图片的 80% 或 50%）。

## 4. 技术实现方案
- **核心库**：使用 `react-image-crop` 库来实现复杂的拖拽、缩放和比例锁定交互。
- **数据流**：
  - `App.tsx` 管理 source crop 状态。
  - `CropOptions.tsx` 组件负责渲染图片和裁切 UI。
  - `converter.ts` 中的 `cropImage` 函数负责实际执行裁切。

## 5. 待确认事项
- [ ] 只有第一张图作为参考，还是允许用户切换查看其他图的裁切效果？（当前设计：仅第一张作为参考）

这里允许



最后一个补充，裁切完了之后缩略图显示的是裁切后的图像，不要显示原始图像 显得好像没有工作